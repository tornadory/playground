<!DOCTYPE html>
<html>
<head>
	<title>Text</title>
</head>

<style>
	body{
		margin: 0;
		overflow: hidden;
	}
</style>
<body>
	<div id="container"></div>
</body>

<script src="bower_components/three.js/build/three.js"></script>
<script src="bower_components/three.js/examples/js/controls/TrackballControls.js"></script>
<script src="bower_components/tween.js/src/Tween.js"></script>
<script src="js/classes/text.js"></script>
<script>
	var camera, scene, renderer, controls, gui;
	var clock = new THREE.Clock();

	var raycaster = new THREE.Raycaster();
	var mouse = new THREE.Vector2;

	var text;
	var glowText = [];

	var glowLoaded = false;

	function resize(){
		camera.aspect = window.innerWidth / window.innerHeight;
		camera.updateProjectionMatrix();
		renderer.setSize( window.innerWidth, window.innerHeight );
	}

	function onMouseMove(){
		mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
		mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;
		raycaster.setFromCamera(mouse, camera);

		var intersects = raycaster.intersectObjects(text.wordsMeshes, true);
		
		if (intersects.length > 0){
			var mesh = intersects[0].object;
			var index;
			for(var i=0; i<text.wordsMeshes.length; i++){
				if (mesh == text.wordsMeshes[i]){
					index = i;
					break;
				}
			}
			text.wordsObjects[index].highlight();
		}
		else{
			for (var i=0; i<text.wordsObjects.length; i++){
				text.wordsObjects[i].dim();
			}
		}
	}

	function init() {
			var container = document.getElementById( 'container' );
			renderer = new THREE.WebGLRenderer({antialias: true});
			renderer.shadowMap.enabled = true;
			renderer.shadowMap.type = THREE.PCSoftShadowMap;
			renderer.setPixelRatio( window.devicePixelRatio );
			renderer.setSize( window.innerWidth, window.innerHeight);
			renderer.setClearColor(0xededed);
			container.appendChild( renderer.domElement );
			
			camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 10000 );
			camera.position.set(0, 0, 50);

			controls = new THREE.TrackballControls(camera, renderer.domElement);
			controls.rotateSpeed = 2.0;
			controls.panSpeed = 0.8;
			controls.zoomSpeed = 1.5;

			scene = new THREE.Scene();

			var directionalLight = new THREE.DirectionalLight(0xffffff, .7);
			directionalLight.position.set(1, -1, 0).normalize();
			directionalLight.castShadow = true;
			var ambientLight = new THREE.AmbientLight(0xffffff);
			var pointLight = new THREE.PointLight(0xffffff);
			pointLight.position.set(0, 0, 0);

			// the box in the scene that rotatates around the light
		    var geometry = new THREE.BoxBufferGeometry( 1, 1, 1 );
		    var material = new THREE.MeshPhongMaterial( { color: 0x111111 } );
		    box = new THREE.Mesh( geometry, material );
		    box.scale.set(10, 10, 10);
		    box.position.z = 0;
		    // scene.add( box );

			var mat = new THREE.MeshBasicMaterial({color : 0xffffff});

		    text = new TextObj(mat, 'Apex is this font', -14, 0, 0);

			window.addEventListener('resize', resize);
			window.addEventListener('mousemove', onMouseMove);
		}

		function update(){
			text.update();
			camera.lookAt(scene.position);
			controls.update();

			TWEEN.update();
		}

		function animate(){
			update();
			renderer.render(scene, camera);
			window.requestAnimationFrame(animate);
		}

		init();
		animate();
</script>
</html>